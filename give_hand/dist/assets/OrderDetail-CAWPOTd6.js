import{_ as g,u as I,r as w,l as p,m as D,c as o,s as l,b as t,t as n,F as $,i as x,e as B,o as c}from"./index-CeEdpuPy.js";import{a as R,c as F,d as N,b as S,e as T}from"./orders-L_Q0EYNJ.js";import"./http-CWkExEYz.js";const V={key:0,class:"page"},E={class:"top"},M={class:"title"},U={class:"main"},j=["src"],q={class:"section"},z={class:"price"},G={class:"status"},H={class:"section"},J={class:"user"},K={class:"avatar-circle"},L={class:"info"},P={class:"name"},Q={class:"section"},W={class:"content"},X={class:"footer"},Y={__name:"OrderDetail",setup(Z){const r=x(),v=B(),f=I(),e=w(null),_=p(()=>{var s;return(s=f.user)==null?void 0:s.uid}),u=p(()=>{var s;return((s=e.value)==null?void 0:s.uid)===_.value}),m=p(()=>{var s;return((s=e.value)==null?void 0:s.acceptorId)===_.value}),h=p(()=>{var a;return{0:"待接单",1:"进行中",2:"已完成",3:"已取消"}[(a=e.value)==null?void 0:a.status]||"未知"});async function d(){const s=r.params.id;e.value=await R(s),console.log("订单详情:",e.value)}async function y(){await T(r.params.id),alert("接单成功"),d()}async function k(){await S(r.params.id),alert("订单已完成"),d()}async function b(){confirm("确定撤销此订单？撤销后无法恢复。")&&(await F(r.params.id),alert("订单已撤销"),d())}async function O(){confirm("确定删除此订单？")&&(await N(r.params.id),alert("订单已删除"),v.back())}function A(){v.push(`/arbitration/apply?orderId=${r.params.id}`)}function C(){var a,i;const s=u.value?(a=e.value)==null?void 0:a.acceptorId:(i=e.value)==null?void 0:i.uid;s?v.push(`/chat/${s}`):alert("对方信息不可用")}return D(d),(s,a)=>{var i;return e.value?(c(),o("div",V,[t("header",E,[t("button",{class:"back",onClick:a[0]||(a[0]=ee=>s.$router.back())},"←"),t("div",M,n(e.value.title),1)]),t("main",U,[e.value.url?(c(),o("img",{key:0,src:e.value.url,class:"image"},null,8,j)):l("",!0),t("div",q,[t("div",z,"¥"+n(e.value.price),1),t("div",G,"状态："+n(h.value),1)]),t("div",H,[t("div",J,[t("div",K,n(((i=e.value.username)==null?void 0:i[0])||"用"),1),t("div",L,[t("div",P,n(e.value.username),1)])])]),t("div",Q,[a[1]||(a[1]=t("h3",null,"订单详情",-1)),t("p",W,n(e.value.content),1)])]),t("footer",X,[u.value?(c(),o($,{key:0},[e.value.status===0?(c(),o("button",{key:0,class:"primary",onClick:b}," 撤销订单 ")):[0,2,3].includes(e.value.status)?(c(),o("button",{key:1,class:"primary",onClick:O}," 删除订单 ")):l("",!0)],64)):m.value&&e.value.status===1?(c(),o("button",{key:1,class:"primary",onClick:k}," 完成订单 ")):!u.value&&!e.value.acceptorId&&e.value.status===0?(c(),o("button",{key:2,class:"primary",onClick:y}," 接取订单 ")):l("",!0),(u.value||m.value)&&[1,2].includes(e.value.status)?(c(),o("button",{key:3,class:"secondary",onClick:A}," 申请仲裁 ")):l("",!0),t("button",{class:"secondary",onClick:C},"联系TA")])])):l("",!0)}}},oe=g(Y,[["__scopeId","data-v-83889a82"]]);export{oe as default};
