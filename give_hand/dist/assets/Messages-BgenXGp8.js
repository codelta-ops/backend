import{_ as p,l as m,c,o as n,b as s,t as l,s as $,r as D,m as M,F as w,f as S,e as x,x as C}from"./index-CeEdpuPy.js";import{g as T}from"./messages-DSU9JwzA.js";import"./http-CWkExEYz.js";const b=["src"],B={class:"content"},F={class:"name"},I={class:"latest"},N={class:"info"},A={class:"time"},L={key:0,class:"badge"},U={__name:"MessageItem",props:{message:{type:Object,required:!0,default:()=>({})}},setup(o){const r=o,i=m(()=>r.message.avatar||"https://api.dicebear.com/7.x/initials/svg?seed="+(r.message.username||"U")),u=m(()=>{const t=r.message.time;if(!t)return"";let e;if(Array.isArray(t)){const[_,h,f,y,k]=t;e=new Date(_,h-1,f,y,k)}else typeof t=="string"?e=new Date(t):e=t;if(isNaN(e.getTime()))return"";const a=new Date,g=new Date(a.getFullYear(),a.getMonth(),a.getDate());return new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()===g.getTime()?`${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`:a.getTime()-e.getTime()<7*24*60*60*1e3?["周日","周一","周二","周三","周四","周五","周六"][e.getDay()]:`${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}),d=m(()=>{const t=r.message.count||0;return t>99?"99+":t});return(t,e)=>(n(),c("div",{class:"message-item",onClick:e[0]||(e[0]=a=>t.$emit("click"))},[s("img",{src:i.value,class:"avatar",alt:""},null,8,b),s("div",B,[s("div",F,l(o.message.username),1),s("div",I,l(o.message.latestMsg||"无消息"),1)]),s("div",N,[s("div",A,l(u.value),1),o.message.count&&o.message.count>0?(n(),c("div",L,l(d.value),1)):$("",!0)])]))}},V=p(U,[["__scopeId","data-v-65a66163"]]),Y={class:"page"},j={class:"main"},q={key:0,style:{padding:"20px",color:"#999"}},E={key:1},H={__name:"Messages",setup(o){const r=x(),i=D([]);async function u(){const t=await T();i.value=t||[]}function d(t){t.uid&&r.push(`/chat/${t.uid}`)}return M(u),(t,e)=>(n(),c("div",Y,[e[0]||(e[0]=s("header",{class:"header"},[s("h2",null,"消息列表")],-1)),s("main",j,[i.value.length===0?(n(),c("div",q," 暂无消息 ")):(n(),c("div",E,"共 "+l(i.value.length)+" 条消息",1)),(n(!0),c(w,null,S(i.value,(a,g)=>(n(),C(V,{key:g,message:a,onClick:v=>d(a)},null,8,["message","onClick"]))),128))])]))}},G=p(H,[["__scopeId","data-v-ac2715ec"]]);export{G as default};
