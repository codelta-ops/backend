import{_ as A,r as t,i as C,l as q,A as B,c as d,b as o,w as N,v as V,q as D,s as k,d as w,F as M,f as z,t as F,e as I,o as c,x as K}from"./index-CeEdpuPy.js";import{s as S,T as $}from"./TaskCard-0sBTdkhh.js";import"./http-CWkExEYz.js";const E={class:"page"},J={class:"header"},L={key:0,class:"refresh-indicator"},O={key:1,class:"empty"},P={class:"grid"},U={key:2,class:"load-more"},j=["disabled"],G=8,H={__name:"SearchResult",setup(Q){const m=C(),g=I(),r=t(m.query.keyword||""),a=t([]),v=t(1),n=t(0),u=t(!1),f=t(!1),b=t(null),y=q(()=>a.value.length<n.value);async function _(s=!1){var l;console.log("ðŸš€ [1] è¿›å…¥ fetchSearchResults, isRefresh:",s),console.log("ðŸ” [2] å½“å‰ keyword.value:",r.value),s&&(v.value=1);const e=r.value.trim();if(console.log("ðŸ“ [3] å¤„ç†åŽçš„å…³é”®è¯ kw:",JSON.stringify(e)),!e){console.log("âš ï¸ [4] å…³é”®è¯ä¸ºç©ºï¼Œæ¸…ç©ºåˆ—è¡¨"),a.value=[],n.value=0;return}u.value=!0,f.value=s;try{const i={keyword:e,page:v.value,size:G};console.log("ðŸ“¡ [5] å‡†å¤‡è°ƒç”¨ searchTasksApiï¼Œå‚æ•°:",i),console.log("ðŸ”§ [6] searchTasksApi å‡½æ•°:",S);const h=await S(i);console.log("âœ… [7] æ”¶åˆ° API å“åº”:",h);const p=h.results||[];console.log("ðŸ“‹ [8] è§£æžå‡ºçš„åˆ—è¡¨é•¿åº¦:",p.length),s?a.value=p:a.value.push(...p),n.value=((l=h.data)==null?void 0:l.total)||0}catch(i){console.error("âŒ [9] æœç´¢å¤±è´¥:",i),a.value=[],n.value=0}finally{u.value=!1,f.value=!1,console.log("ðŸ”š [10] fetchSearchResults ç»“æŸ")}}function R(){const s=r.value.trim();s&&g.replace({query:{keyword:s}})}B(()=>m.query.keyword,s=>{const e=(s||"").trim();r.value=e,e?(v.value=1,a.value=[],n.value=0,_(!0)):(a.value=[],n.value=0)},{immediate:!0});function T(){!y.value||u.value||(v.value++,_(!1))}function x(s){g.push(`/orders/${s}`)}return(s,e)=>(c(),d("div",E,[o("header",J,[N(o("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>r.value=l),class:"search",placeholder:"æœç´¢ä»»åŠ¡æ ‡é¢˜æˆ–ç”¨æˆ·",onKeyup:D(R,["enter"])},null,544),[[V,r.value]])]),o("main",{class:"main",ref_key:"mainRef",ref:b},[f.value?(c(),d("div",L,[...e[1]||(e[1]=[o("div",{class:"refresh-spinner"},null,-1),o("span",null,"åˆ·æ–°ä¸­...",-1)])])):k("",!0),a.value.length===0&&!u.value?(c(),d("div",O,[...e[2]||(e[2]=[w(" æ²¡æœ‰æ‰¾åˆ°ç›¸å…³ç»“æžœ",-1),o("br",null,null,-1),w("æ¢ä¸ªå…³é”®è¯è¯•è¯•å§ ",-1)])])):k("",!0),o("div",P,[(c(!0),d(M,null,z(a.value,l=>(c(),K($,{key:l.id,task:l,onClick:i=>x(l.id)},null,8,["task","onClick"]))),128))]),y.value?(c(),d("div",U,[o("button",{onClick:T,disabled:u.value,class:"load-more-btn"},F(u.value?"åŠ è½½ä¸­...":"åŠ è½½æ›´å¤š"),9,j)])):k("",!0)],512)]))}},Z=A(H,[["__scopeId","data-v-b9ec134e"]]);export{Z as default};
